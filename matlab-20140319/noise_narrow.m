function [Nnar,F,Pxx,fr]=noise_narrow(custom,night,ns,nm)
%调用默认参数方式：noise_narrow(0,0)

%输入参数：
%custom=0，采用系统自定义参数；custom不为0时，采用用户自定义的短波电台和中波电台数；
%ns：短波电台个数；
%nm：中波电台个数；
%night=1,表示调用夜晚的参数；

%输出参数：
%Nnar:窄带噪声；
%F:输出的频谱；
%Pxx:输出的功率谱；
%fr:频域上采样频率；
%clf;
%clc;
if custom==0
    Nshort=686;
    Nmiddle=120;
else 
    Nshort=ns;
    Nmiddle=nm;
end
if night==0
   A=[-65 -85];
else
    A=[-30 -70];
end
A=(10.^((A+48.75)/20))*10^-3;
Fshort=[7160 9580 9610 11945 11980 13790 9580 11980	13790 7330 9605	11945 15285	21660 6090 7105	7330 9605 15285	7150 7190 7200 9510 9545 11925 13775 7190 9545 11830 11925 15150 15385 17765 9545 11830	11925 15385	17765 12010	13610 13720	13740 15160	15250 17855 ... 
        21540 21705	11825 11895	12010 13610	13720 13740	15160 15250	15665 17855	9575 11825 11895 12010 13610 13740 15160 15230 15250 15665 17855 1170 6110 9575	11785 11825	11965 11990	12040 15250	6110 9845 11785	11805 11825	11965 11990	12040 6110	9770 9845 ...
        11805 11965	11990 12040	15680 13625	11935 11740	9920 9910 9850 7540	7105 15680 15585 15430 13775 13670 11760 9910 7540 21690 17880 17615 17525 17495 15685 15130 13760 13670 17880 17615 17525 17495 15685 15165 13760 13670 15680 15495 13725 13675 12025 ...
        11765 9905 9455	7540 15680 15530 13715 13675 12025 11795 9905 9455 7540 15680 13715 13625 11795	9905 9540 9525 9455	9355 7540 7280 15680 15510 13625 11700 11520 9865 9540 9455	9355 7540 7530 7280	15680 15510	13625 11700	11520 9905 9865	9760 9455 9355 ...
        7540 7530 7260 15680 13625 11785 11740 11520 9905 9850 9455	9355 7540 7530 7260	12000 9470 7300	5940 12000 9470 7355 7390 7300 5940	13590 12000	9470 7300 13590	9640 7300 12010	11660 9475 9525	9870 12035 5840	9525 11780 12035 13660 5840	9785 11700 9560	...
        13650 17810	13630 17845	17860 6190 11740 6190 12005	12045 747 1098 11875 11890 12025 1494 9805 12075 1503 5975 7275	9805 6065 9770 5975	6135 7275 9580 7370 15190 15490 17820 15355	15425 17660	5945 6175 9686 17705 15795 11840 15320 15270 15525 11940 ...
        11715 11635 11605 15465	15265 17750	9955 3965 15270	9415 7445 6185 6000 15070 11570	6000 13715 11975 11785 15230 12000 11735 17545 17535 15190 15160 11685 17740 15445 17810 15380 11685 9525 15150	5060 15295 11885 9580 17715	6140 7180 7190 7220 7265 ...
        7325 9460 9695 9765 11945 6140 7325	9460 11945 15100 15350 17540 17650 9660 11980 15110 15250 15440	11980 15250 17650 17625	11875 9855 7160 9855 11875 7160	9560 17560 7160	9645 9685 9745 11660 11835 6100	7120 7245 7335 9770	9865 11535 9975	9345 7180 ...
        3560 12020 9840 9550 7220 9550 7220	9550 7220 9550 7220	12085 6190 9520	7300 9600 11830	6020 15455 17515 11610 11765 13630 9865	9910 12130 9455	12065 15450	9405 9375 11580	9405 15510 9430 7235 9280 7250 9280	1557 1098 11895	11750 12120	15215 15370 ...
        12120 15590	12025 15590 15520 12025	15510 15615 12105 11975 11770 15145 12105 9720 15320 12105 9695	9965 1566 11765	9615 9780 15525	1188 15165 17830 13775 13695 7220 12065	17510 9930 11555 9450 7205 11940 1116 5925 7620 9380 11620 11935 15710 1116	5925 ...
        7620 9380 11620	11935 1116 5925 7620 9380 11620	11935 15710	7280 11590 6115 7280 11590 6115	3280 4950 5075 9705 1089 6140 6165 9170	11905 15880 1089 6140 6165 9170 11905 15880 1089 6140 6165 9170 6185 5860 1206 17890 17550 15370 12055 11750 9710 9590 ...
        7345 7110 6080 17615 15550 15300 11960 11720 9860 9675 9500	7305 6950 6030 17605 15480 15180 11925 11710 9845 9655 9460	7290 6175 5030 17580 15390 13700 11860 11630 9830 9645 7275	6165 4800 17565	15380 13610	11760 9900 9810	9630 7935 7230 6125	4750 ...
        4460 17890 17550 15370 12055 11750 9890	9710 9590 7345 7110	6080 17615 15550 15300 11960 11720 9860	9675 9500 7305 6950	6030 17605 15480 15180 11925 11710 9845	9655 9460 7290 6175	5030 17580 15390 13700 11860 11630 9830	9645 9455 7275 6165	4800 17565 ...
        15380 13610 11760 9900 9810	9630 7935 7230 6125	4750 4460 17625 12080 11740	11610 9730 9515	7315 6155 15570	11915 11685	9820 9720 9480 7150	6090 15540 11845 11670 9810	9620 7375 7140 6065	15500 11835	11660 9775 9570	7360 7130 6010 15270 11800 11635  ...
        9530 7335 6190 3985	3900 3950 4000 4620	6045 4750 4820 5935	6050 7170 7550 11695 11860 11950 4820 5935 6050	7170 7550 11695	11860 11950	4840 4865 4930 4975	4990 5040 5060	5900 5960 6025 6035	6060 6176 6260 7105	7165 9520 7155 7225 7275 7310 7350 9600 ...
        9755 11770]*10^3;
Fmiddle=(531:9:1602)*10^3;
l=length(Fshort);
x=randperm(length(Fshort));
fshort=Fshort([x([1:Nshort])]);
x=randperm(length(Fmiddle));
fmiddle=Fmiddle([x([1:Nmiddle])]);
f=[fmiddle fshort];
l=length(f);
a=A(2)+rand(1,length(f))*(A(1)-A(2));
t_s=1/(6*10^7);%1.67*10^-8
fs=6*10^7;
t_sim=0:t_s:0.02;
L=length(t_sim);%仿真长度0.02s,采样间隔按1/60M，产生的噪声长度就相当于对是及噪声的采样了
Nnar=zeros(1,L);
for i=1:l
N=a(i)*sin(2*pi*f(i)*t_sim+2*pi*rand);
Nnar=Nnar+N;
end

figure(1);
plot(t_sim,Nnar);
%title('窄带背景噪声');
xlabel('时间 (s)');
ylabel('幅度 (V)');

%求频谱密度
[F,fr]=freqspec(Nnar,fs);
figure(2);
plot(fr,F);
%title('窄带噪声频谱');
xlabel('频率 (Hz)');
ylabel('幅度')

%求功率谱密度 
Pxx = 1/L * F.*conj(F);
figure(3);
plot(fr,Pxx);
%title('窄带噪声功率谱密度');
xlabel('频率 (Hz)');
ylabel('功率 (W)')